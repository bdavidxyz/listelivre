<% content_for :javascript do %>
<%= javascript_pack_tag 'welcome', 'data-turbolinks-track': 'reload' %>
<% end %>

<%- livres = local_assigns[:livres] %>
<% if current_user %>
Bienvenue, <%= current_user.email %>
<span style="display: flex;">
  <%= button_to "Se déconnecter", sign_out_path, method: :delete %>
  <%= link_to "Ajouter mes livres", admin_root_path, class: "add-your-books" %>
</span>
<% else %>
<%= link_to "Se connecter", admin_root_path, class: "add-your-books" %>
<% end %>

<br>
<div>&nbsp;</div>
<h1>Bibliothèque de la transition</h1>
<% if current_user %>
  <p>Pour louer un livre, <strong>contactez directement le propriétaire en cliquant sur son email</strong></p>
<% else %>
  <p>Pour les habitants de La-Chapelle-sur-Erdre et ses environs</p>
<% end %>

<table id="main_table" class="books">
  <caption></caption>
  <thead>
    <tr>
      <th align="left">Titre ↓</th>
      <th align="left">Auteur ↓</th>
      <th align="left">Genre ↓</th>
      <% if livres.try('first').try(:[], :proprietaire) %>
      <th align="left">Propriétaire ↓</th>
      <% end %>
    </tr>
  </thead>
  <tbody class="list">
    <% livres.each do |livre| %>
    <tr>
      <td align="left" class="titre"><%= livre[:titre] %></td>
      <td align="left" class="auteur"><%= livre[:auteur] %></td>
      <td align="left" class="genre"><%= livre[:genre] %></td>
      <% if livre.try(:[], :proprietaire) %>
      <td align="left" class="proprietaire"><%= livre[:proprietaire] %></td>
      <% end %>
    </tr>
    <% end %>
  </tbody>
</table>

<style type="text/css">
  #main_table_info {
    display: none;
  }
  #main_table th {
    cursor: pointer;
  }
</style>
